---
name: 'step-v-08-domain-compliance-validation'
description: '领域合规性验证 - 验证高复杂性领域的特定领域需求是否已记录'

# File references (ONLY variables used in this step)
nextStepFile: './step-v-09-project-type-validation.md'
prdFile: '{prd_file_path}'
prdFrontmatter: '{prd_frontmatter}'
validationReportPath: '{validation_report_path}'
domainComplexityData: '../data/domain-complexity.csv'
---

# 步骤 8: 领域合规性验证

## 步骤目标：

验证高复杂性领域（医疗保健、金融科技、政府科技等）的特定领域需求是否已记录，确保法规和合规性要求得到适当记录。

## 强制执行规则 (请先阅读):

### 通用规则：

- 🛑 绝不 在没有用户输入的情况下生成内容
- 📖 关键：在采取任何行动之前，请阅读完整的步骤文件
- 🔄 关键：当使用 'C' 加载下一步时，确保已阅读整个文件
- 📋 你是一个协调员，而不是内容生成器
- ✅ 你必须始终使用配置的 `{communication_language}` 以你的 Agent 沟通风格输出语言

### 角色强化：

- ✅ 你是验证架构师和质量保证专家
- ✅ 如果你已经被赋予了沟通或人物模式，在扮演这个新角色时继续使用它们
- ✅ 我们参与系统验证，而不是协作对话
- ✅ 你带来领域专业知识和合规性知识
- ✅ 此步骤自动运行 - 不需要用户输入

### 步骤特定规则：

- 🎯 仅关注 具体领域合规性需求
- 🚫 禁止 在此步骤中验证其他方面
- 💬 方法：基于领域分类的有条件验证
- 🚪 这是一个验证序列步骤 - 完成后自动继续

## 执行协议：

- 🎯 检查 PRD frontmatter 中的 classification.domain
- 💬 如果低复杂性（通用）：跳过详细检查
- 🎯 如果高复杂性：验证所需的特殊部分
- 💾 将合规性发现追加到验证报告
- 📖 显示 "正在进行下一步检查..." 并加载下一步
- 🚫 禁止 暂停或请求用户输入

## 上下文边界：

- 可用上下文：带有 frontmatter 分类的 PRD 文件，验证报告
- 重点：仅领域合规性（取决于领域复杂性）
- 限制：不验证其他方面，有条件执行
- 依赖项：步骤 2-7 已完成 - 格式和需求验证已完成

## 强制序列

**关键：** 严格遵循此序列。除非用户明确要求更改，否则不要跳过、重新排序或即兴发挥。

### 1. 加载领域复杂性数据

加载并阅读完整文件：
`{domainComplexityData}` (../data/domain-complexity.csv)

此 CSV 包含：
- 领域分类和复杂性级别 (高/中/低)
- 每个领域所需的特殊部分
- 受监管行业的关键关注点和要求

内化此数据 - 它驱动哪些领域需要特殊的合规性部分。

### 2. 提取领域分类

从 PRD frontmatter 提取：
- `classification.domain` - 此 PRD 属于哪个领域？

**如果未找到领域分类：**
视为“通用”（低复杂性）并继续进行第 4 步

### 3. 确定领域复杂性

**低复杂性领域（跳过详细检查）：**
- 通用
- 消费者应用（标准电子商务、社交、生产力）
- 内容网站
- 商业工具（标准）

**高复杂性领域（需要特殊部分）：**
- 医疗保健 / 健康科技
- 金融科技 / 金融服务
- 政府科技 / 公共部门
- 教育科技（教育记录、认证课程）
- 法律科技
- 其他受监管领域

### 4. 对于高复杂性领域：验证所需的特殊部分

**尝试子流程验证：**

"执行 {domain} 的领域合规性验证：

根据 {domain} 要求，检查 PRD 中的：

**医疗保健:**
- 临床要求部分
- 监管路径 (FDA, HIPAA 等)
- 安全措施
- HIPAA 合规 (数据隐私, 安全)
- 患者安全考虑

**金融科技:**
- 合规矩阵 (SOC2, PCI-DSS, GDPR 等)
- 安全架构
- 审计要求
- 欺诈预防措施
- 金融交易处理

**政府科技:**
- 无障碍标准 (WCAG 2.1 AA, Section 508)
- 采购合规性
- 安全许可要求
- 数据驻留要求

**其他受监管领域:**
- 检查特定领域的监管部分
- 合规要求
- 特殊注意事项

对于每个所需部分：
- PRD 中是否存在？
- 记录是否充分？
- 注意任何差距

返回带有存在/充分性评估的合规性矩阵。"

**优雅降级（如果无 Task 工具）：**
- 根据领域手动检查所需部分
- 列出存在的部分和缺失的部分
- 评估文档的充分性

### 5. 对于低复杂性领域：跳过详细检查

追加到验证报告：
```markdown
## 领域合规性验证

**领域:** {domain}
**复杂性:** 低 (通用/标准)
**评估:** N/A - 无特殊领域合规要求

**注意:** 此 PRD 适用于没有监管合规要求的标准领域。
```

显示："**领域合规性验证已跳过**

领域：{domain} (低复杂性)

**正在进行下一步验证检查...**"

毫不延迟，完整阅读并遵循：{nextStepFile}

### 6. 报告合规性发现（高复杂性领域）

追加到验证报告：

```markdown
## 领域合规性验证

**领域:** {domain}
**复杂性:** 高 (受监管)

### 所需特殊部分

**{Section 1 Name}:** [存在/缺失/充分]
{如果缺失或不充分: 注意具体差距}

**{Section 2 Name}:** [存在/缺失/充分]
{如果缺失或不充分: 注意具体差距}

[继续所有所需部分]

### 合规性矩阵

| 需求 | 状态 | 备注 |
|-------------|--------|-------|
| {Requirement 1} | [满足/部分/缺失] | {Notes} |
| {Requirement 2} | [满足/部分/缺失] | {Notes} |
[... 继续所有需求]

### 摘要

**所需部分存在:** {count}/{total}
**合规性差距:** {count}

**严重性:** [严重 如果缺少监管部分, 警告 如果不完整, 通过 如果完整]

**推荐:**
[如果严重] "PRD 缺少所需的特定领域合规性部分。这对于 {domain} 产品至关重要。"
[如果警告] "一些领域合规性部分不完整。加强文档以实现完全合规。"
[如果通过] "所有所需的领域合规性部分均存在且记录充分。"
```

### 7. 显示进度并自动继续

显示："**领域合规性验证完成**

领域：{domain} ({complexity})
合规性状态：{status}

**正在进行下一步验证检查...**"

毫不延迟，完整阅读并遵循：{nextStepFile} (step-v-09-project-type-validation.md)

---

## 🚨 系统成功/失败指标

### ✅ 成功：

- 正确提取领域分类
- 适当地评估复杂性
- 低复杂性领域：带有清晰 "N/A" 文档的跳过
- 高复杂性领域：检查所有所需部分
- 构建带有个需求状态的合规性矩阵
- 正确评估严重性
- 将发现报告给验证报告
- 自动继续进行下一个验证步骤
- 尝试子流程架构并进行优雅降级

### ❌ 系统失败：

- 未在继续之前检查领域分类
- 对低复杂性领域执行详细检查
- 对于高复杂性：缺少所需部分的检查
- 未构建合规性矩阵
- 未将发现报告给验证报告
- 未自动继续

**主规则：** 领域合规性是有条件的。高复杂性领域需要特殊部分 - 低复杂性领域跳过这些检查。
