---
name: 'step-v-04-brief-coverage-validation'
description: '产品简介覆盖检查 - 验证 PRD 是否涵盖产品简介中的所有内容（如果用作输入）'

# File references (ONLY variables used in this step)
nextStepFile: './step-v-05-measurability-validation.md'
prdFile: '{prd_file_path}'
productBrief: '{product_brief_path}'
validationReportPath: '{validation_report_path}'
---

# 步骤 4: 产品简介覆盖验证

## 步骤目标：

验证 PRD 是否涵盖产品简介中的所有内容（如果简介被用作输入），将简介内容映射到 PRD 部分并识别差距。

## 强制执行规则 (请先阅读):

### 通用规则：

- 🛑 绝不 在没有用户输入的情况下生成内容
- 📖 关键：在采取任何行动之前，请阅读完整的步骤文件
- 🔄 关键：当使用 'C' 加载下一步时，确保已阅读整个文件
- 📋 你是一个协调员，而不是内容生成器
- ✅ 你必须始终使用配置的 `{communication_language}` 以你的 Agent 沟通风格输出语言

### 角色强化：

- ✅ 你是验证架构师和质量保证专家
- ✅ 如果你已经被赋予了沟通或人物模式，在扮演这个新角色时继续使用它们
- ✅ 我们参与系统验证，而不是协作对话
- ✅ 你带来分析严谨性和可追溯性专业知识
- ✅ 此步骤自动运行 - 不需要用户输入

### 步骤特定规则：

- 🎯 仅关注 产品简介覆盖（取决于简介是否存在）
- 🚫 禁止 在此步骤中验证其他方面
- 💬 方法：系统映射和差距分析
- 🚪 这是一个验证序列步骤 - 完成后自动继续

## 执行协议：

- 🎯 检查输入文档中是否存在产品简介
- 💬 如果无简介：跳过此检查并报告 "N/A - 无产品简介"
- 🎯 如果简介存在：将简介内容映射到 PRD 部分
- 💾 将覆盖发现追加到验证报告
- 📖 显示 "正在进行下一步检查..." 并加载下一步
- 🚫 禁止 暂停或请求用户输入

## 上下文边界：

- 可用上下文：PRD 文件，来自步骤 1 的输入文档，验证报告
- 重点：仅产品简介覆盖（有条件）
- 限制：不验证其他方面，有条件执行
- 依赖项：步骤 1 已完成 - 输入文档已加载

## 强制序列

**关键：** 严格遵循此序列。除非用户明确要求更改，否则不要跳过、重新排序或即兴发挥。

### 1. 检查产品简介

检查步骤 1 的 inputDocuments 中是否加载了产品简介：

**如果未找到产品简介：**
追加到验证报告：
```markdown
## 产品简介覆盖

**状态:** N/A - 未提供产品简介作为输入
```

显示："**产品简介覆盖：跳过**（未提供产品简介）

**正在进行下一步验证检查...**"

毫不延迟，完整阅读并遵循：{nextStepFile}

**如果存在产品简介：** 继续下面的第 2 步

### 2. 尝试子流程验证

**尝试使用 Task 工具生成子流程：**

"执行产品简介覆盖验证：

1. 加载产品简介
2. 提取关键内容：
   - 愿景陈述
   - 目标用户/角色
   - 问题陈述
   - 关键功能
   - 目标/目的
   - 差异化因素
   - 约束
3. 对于每个项目，搜索 PRD 中的相应覆盖
4. 分类覆盖：完全覆盖 / 部分覆盖 / 未找到 / 故意排除
5. 注意任何带有严重性的差距：严重 / 中等 / 信息

返回带有分类的结构化覆盖图。"

### 3. 优雅降级（如果 Task 工具不可用）

如果 Task 工具不可用，直接执行分析：

**从产品简介提取：**
- 愿景：这是什么产品？
- 用户：它是为谁服务的？
- 问题：它解决了什么问题？
- 功能：关键能力是什么？
- 目标：成功标准是什么？
- 差异化因素：什么使它独特？

**对于每个项目，搜索 PRD:**
- 扫描执行摘要以获取愿景
- 检查用户旅程或用户角色
- 寻找问题陈述
- 审查功能需求以获取功能
- 检查成功标准部分
- 搜索差异化因素

**分类覆盖：**
- **完全覆盖：** 内容存在且完整
- **部分覆盖：** 内容存在但不完整
- **未找到：** PRD 中缺少内容
- **故意排除：** 内容明确超出范围

### 4. 评估覆盖和严重性

**对于每个差距（部分覆盖或未找到）：**
- 这是严重的吗？（核心愿景、主要用户、主要功能）
- 这是中等的吗？（次要功能、一些目标）
- 这是信息的吗？（有也没错的功能、次要细节）

**注意：** 一些排除可能是故意的（有效的范围决策）

### 5. 向验证报告报告覆盖发现

追加到验证报告：

```markdown
## 产品简介覆盖

**产品简介:** {brief_file_name}

### 覆盖图

**愿景陈述:** [完全/部分/未找到/故意排除]
[如果差距: 注意严重性和具体缺失内容]

**目标用户:** [完全/部分/未找到/故意排除]
[如果差距: 注意严重性和具体缺失内容]

**问题陈述:** [完全/部分/未找到/故意排除]
[如果差距: 注意严重性和具体缺失内容]

**关键功能:** [完全/部分/未找到/故意排除]
[如果差距: 列出具体功能及严重性]

**目标/目的:** [完全/部分/未找到/故意排除]
[如果差距: 注意严重性和具体缺失内容]

**差异化因素:** [完全/部分/未找到/故意排除]
[如果差距: 注意严重性和具体缺失内容]

### 覆盖摘要

**总体覆盖:** [百分比或定性评估]
**严重差距:** [count] [list if any]
**中等差距:** [count] [list if any]
**信息差距:** [count] [list if any]

**推荐:**
[如果有严重差距] "PRD 应进行修订以涵盖关键的产品简介内容。"
[如果有中等差距] "考虑解决中等差距以获得完整覆盖。"
[如果差距极小] "PRD 提供了对产品简介内容的良好覆盖。"
```

### 6. 显示进度并自动继续

显示："**产品简介覆盖验证完成**

总体覆盖：{assessment}

**正在进行下一步验证检查...**"

毫不延迟，完整阅读并遵循：{nextStepFile} (step-v-05-measurability-validation.md)

---

## 🚨 系统成功/失败指标

### ✅ 成功：

- 正确检查产品简介是否存在
- 如果无简介：报告 "N/A" 并优雅跳过
- 如果简介存在：将所有关键简介内容映射到 PRD 部分
- 适当地分类覆盖（完全/部分/未找到/故意排除）
- 评估差距的严重性（严重/中等/信息）
- 将发现报告给验证报告
- 自动继续进行下一个验证步骤
- 尝试子流程架构并进行优雅降级

### ❌ 系统失败：

- 在尝试验证之前未检查简介是否存在
- 如果简介存在：未映射所有关键内容区域
- 缺少覆盖分类
- 未将发现报告给验证报告
- 未自动继续

**主规则：** 产品简介覆盖是有条件的 - 如果无简介则跳过，如果简介存在则彻底验证。始终自动继续。
