---
name: 'step-04-self-check'
description: '针对任务、测试、AC 和模式进行实施自检'

workflow_path: '{project-root}/_bmad/bmm/workflows/bmad-quick-flow/quick-dev'
thisStepFile: './step-04-self-check.md'
nextStepFile: './step-05-adversarial-review.md'
---

# 步骤 4: 自检

**目标：** 在外部审查之前，针对任务、测试、AC 和模式审核已完成的工作。

---

## 可用状态

来自之前的步骤：

- `{baseline_commit}` - 工作流开始时的 Git HEAD
- `{execution_mode}` - "tech-spec" 或 "direct"
- `{tech_spec_path}` - 技术规范文件 (如果为模式 A)
- `{project_context}` - 项目模式 (如果存在)

---

## 自检审核

### 1. 任务完成

验证所有任务都已标记为完成：

- [ ] 所有来自技术规范或心理计划的任务标记为 `[x]`
- [ ] 没有跳过任务，除非有记录原因
- [ ] 任何受阻的任务都有明确解释

### 2. 测试通过

验证测试状态：

- [ ] 所有现有测试仍然通过
- [ ] 为新功能编写了新测试
- [ ] 没有测试警告或无故跳过的测试

### 3. 验收标准满足

对于每个 AC：

- [ ] AC 已明显满足
- [ ] 可以解释实施如何满足 AC
- [ ] 考虑了边缘情况

### 4. 遵循模式

验证代码质量：

- [ ] 遵循代码库中的现有代码模式
- [ ] 遵循 project-context 规则 (如果存在)
- [ ] 错误处理与代码库一致
- [ ] 没有引入明显的代码异味

---

## 更新技术规范 (仅限模式 A)

如果 `{execution_mode}` 是 "tech-spec":

1. 加载 `{tech_spec_path}`
2. 将所有任务标记为 `[x]` 完成
3. 将状态更新为 "Implementation Complete"
4. 保存更改

---

## 实施摘要

提供摘要以过渡到审查：

```
**实施完成！**

**摘要：** {实施了什么}
**修改的文件：** {文件列表}
**测试：** {测试摘要 - 通过/添加/等}
**AC 状态：** {全部满足 / 注意到的问题}

正在进行对抗性代码审查...
```

---

## 下一步

立即继续到 `step-05-adversarial-review.md`.

---

## 成功指标

- 所有任务验证完成
- 所有测试通过
- 所有 AC 满足
- 遵循模式
- 更新技术规范 (如果为模式 A)
- 提供摘要

## 失败模式

- 声称任务完成但实际上未完成
- 继续前未运行测试
- 缺失 AC 验证
- 忽略模式违规
- 未更新技术规范状态 (模式 A)
