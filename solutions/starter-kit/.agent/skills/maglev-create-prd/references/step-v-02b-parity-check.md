---
name: 'step-v-02b-parity-check'
description: '文档平价检查 - 分析非标准 PRD 并识别差距以达到 Maglev PRD 平价'

# File references (ONLY variables used in this step)
nextStepFile: './step-v-03-density-validation.md'
prdFile: '{prd_file_path}'
validationReportPath: '{validation_report_path}'
---

# 步骤 2B: 文档平价检查

## 步骤目标：

分析非标准 PRD 并识别差距以达到 Maglev PRD 平价，向用户展示关于如何继续的选项。

## 强制执行规则 (请先阅读):

### 通用规则：

- 🛑 绝不 在没有用户输入的情况下生成内容
- 📖 关键：在采取任何行动之前，请阅读完整的步骤文件
- 🔄 关键：当使用 'C' 加载下一步时，确保已阅读整个文件
- 📋 你是一个协调员，而不是内容生成器
- ✅ 你必须始终使用配置的 `{communication_language}` 以你的 Agent 沟通风格输出语言

### 角色强化：

- ✅ 你是验证架构师和质量保证专家
- ✅ 如果你已经被赋予了沟通或人物模式，在扮演这个新角色时继续使用它们
- ✅ 我们参与协作对话，而不是命令-响应
- ✅ 你带来 Maglev PRD 标准专业知识和差距分析
- ✅ 用户带来领域专业知识和 PRD 上下文

### 步骤特定规则：

- 🎯 仅关注 分析差距和估算平价工作量
- 🚫 禁止 在此步骤中执行其他验证检查
- 💬 方法：带有明确建议的系统差距分析
- 🚪 这是一个可选的分支步骤 - 用户选择下一步行动

## 执行协议：

- 🎯 分析每个 Maglev PRD 部分的差距
- 💾 将平价分析追加到验证报告
- 📖 展示选项并等待用户决定
- 🚫 禁止 在没有用户选择的情况下继续

## 上下文边界：

- 可用上下文：来自步骤 2 的非标准 PRD，进行中的验证报告
- 重点：仅平价分析 - 缺少什么，需要什么
- 限制：不执行验证检查，不自动继续
- 依赖项：步骤 2 将 PRD 分类为非标准，用户选择了平价检查

## 强制序列

**关键：** 严格遵循此序列。除非用户明确要求更改，否则不要跳过、重新排序或即兴发挥。

### 1. 分析每个 Maglev PRD 部分

对于 6 个 Maglev PRD 核心部分中的每一个，分析：

**执行摘要:**
- PRD 是否有愿景/概述？
- 问题陈述是否清晰？
- 是否识别了目标用户？
- 差距：[缺失或不完整的内容]

**成功标准:**
- 是否定义了可衡量的目标？
- 是否明确定义了成功？
- 差距：[缺失或不完整的内容]

**产品范围:**
- 范围定义是否清晰？
- 是否列出了范围内项目？
- 是否列出了范围外项目？
- 差距：[缺失或不完整的内容]

**用户旅程:**
- 是否识别了用户类型/角色？
- 是否记录了用户流程？
- 差距：[缺失或不完整的内容]

**功能需求:**
- 是否列出了特性/能力？
- 需求是否结构化？
- 差距：[缺失或不完整的内容]

**非功能需求:**
- 是否定义了质量属性？
- 是否记录了性能/安全性等要求？
- 差距：[缺失或不完整的内容]

### 2. 估算达到平价的工作量

对于每个缺失或不完整的部分，估算：

**工作量级别：**
- 极小 - 部分存在但需要少量增强
- 中等 - 部分缺失但 PRD 其他地方存在内容
- 显著 - 部分缺失，需要创建新内容

**总平价工作量:**
- 基于单个部分估算
- 总体分类：快速 / 中等 / 大量工作

### 3. 向验证报告报告平价分析

追加到验证报告：

```markdown
## 平价分析 (非标准 PRD)

### 逐节差距分析

**执行摘要:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

**成功标准:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

**产品范围:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

**用户旅程:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

**功能需求:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

**非功能需求:**
- 状态: [存在/缺失/不完整]
- 差距: [specific gap description]
- 完成工作量: [极小/中等/显著]

### 总体平价评估

**达到 Maglev 标准的总工作量:** [快速/中等/大量]
**推荐:** [基于分析的简要推荐]
```

### 4. 展示平价分析和选项

显示：

"**平价分析完成**

你的 PRD 缺少 6 个核心 Maglev PRD 部分中的 {count} 个。达到 Maglev 标准的总体工作量是：**{effort level}**

**快速摘要：**
[2-3 summary of key gaps]

**推荐：**
{recommendation from analysis}

**你想如何继续？**"

### 5. 展示菜单选项

**[C] 继续验证** - 使用当前结构继续验证
**[E] 退出并审查** - 退出验证并审查平价报告
**[S] 保存并退出** - 保存平价报告并退出

#### 执行规则：

- 始终 停止并等待用户输入
- 仅根据用户选择继续

#### 菜单处理逻辑：

- 如果 C (继续): 显示 "继续验证..." 然后完整阅读并遵循：{nextStepFile}
- 如果 E (退出): 显示平价摘要并退出验证
- 如果 S (保存): 确认已保存，显示摘要，退出验证
- 如果 其他: 帮助用户响应，然后重新显示菜单

---

## 🚨 系统成功/失败指标

### ✅ 成功：

- 分析所有 6 个 Maglev PRD 部分的差距
- 为每个差距提供工作量估算
- 正确评估总体平价工作量
- 将平价分析报告给验证报告
- 向用户展示清晰摘要
- 用户可以选择继续验证、退出或保存报告

### ❌ 系统失败：

- 未系统地分析所有 6 个部分
- 缺少工作量估算
- 未将平价分析报告给验证报告
- 未经用户决定自动继续
- 推荐不明确

**主规则：** 平价检查告知用户差距和工作量，但由用户决定是继续验证还是先解决差距。
