---
name: 'step-e-04-complete'
description: '完成与验证 - 展示后续步骤的选项，包括完全验证'

# File references (ONLY variables used in this step)
prdFile: '{prd_file_path}'
validationWorkflow: './steps-v/step-v-01-discovery.md'
---

# 步骤 E-4: 完成与验证

## 步骤目标：

展示已完成编辑的摘要，并提供包括与验证工作流无缝集成在内的后续步骤选项。

## 强制执行规则 (请先阅读):

### 通用规则：

- 🛑 始终 在用户输入/批准下生成内容
- 📖 关键：在采取任何行动之前，请阅读完整的步骤文件
- 🔄 关键：当使用 'C' 加载下一步时，确保已阅读整个文件
- 📋 你是一个协调员，而不是内容生成器
- ✅ 你必须始终使用配置的 `{communication_language}` 以你的 Agent 沟通风格输出语言

### 角色强化：

- ✅ 你是验证架构师和 PRD 改进专家
- ✅ 如果你已经被赋予了沟通或人物模式，在扮演这个新角色时继续使用它们
- ✅ 我们参与协作对话，而不是命令-响应
- ✅ 你带来综合和摘要专业知识
- ✅ 用户选择下一步行动

### 步骤特定规则：

- 🎯 仅关注 展示摘要和选项
- 🚫 禁止 进行额外更改
- 💬 方法：清晰、简洁的摘要，带有可操作的选项
- 🚪 这是最后的编辑步骤 - 不再编辑

## 执行协议：

- 🎯 编译所有所做更改的摘要
- 🎯 清晰展示带有预期结果的选项
- 📖 如果用户选择，路由到验证
- 🚫 禁止 在没有用户选择的情况下继续

## 上下文边界：

- 可用上下文：更新后的 PRD 文件，来自步骤 e-03 的编辑历史
- 重点：仅摘要和选项（不再编辑）
- 限制：不进行更改，只展示选项
- 依赖项：步骤 e-03 已完成 - 所有编辑已应用

## 强制序列

**关键：** 严格遵循此序列。除非用户明确要求更改，否则不要跳过、重新排序或即兴发挥。

### 1. 编译编辑摘要

从步骤 e-03 变更执行，编译：

**所做的更改：**
- 添加的部分：{list with names}
- 更新的部分：{list with names}
- 删除的内容：{list}
- 结构更改：{description}

**编辑详情：**
- 受影响的总部分：{count}
- 模式：{restructure/targeted/both}
- 解决的优先级：{Critical/High/Medium/Low}

**PRD 状态：**
- 格式：{BMAD Standard / BMAD Variant / Legacy (converted)}
- 完整性：{assessment}
- 准备好用于：{downstream use cases}

### 2. 展示完成摘要

显示：

"**✓ PRD 编辑完成**

**更新后的 PRD：** {prd_file_path}

**更改摘要：**
{Present bulleted list of major changes}

**编辑模式：** {mode}
**修改的部分：** {count}

**PRD 格式：** {format}

**PRD 现在准备好用于：**
- 下游工作流（UX 设计，架构）
- 验证以确保质量
- 生产使用

**你接下来想做什么？**"

### 3. 展示菜单选项

显示：

**[V] 运行完整验证** - 执行完整验证工作流 (steps-v) 以验证 PRD 质量
**[E] 编辑更多** - 对 PRD 进行额外编辑
**[S] 摘要** - 以更改的详细摘要结束
**[X] 退出** - 退出编辑工作流

#### 执行规则：

- 始终 停止并等待用户输入
- 仅根据用户选择继续

#### 菜单处理逻辑：

- **如果 V (运行完整验证):**
  - 显示："**正在启动验证工作流**"
  - 显示："这将对更新后的 PRD 运行所有 13 个验证检查。"
  - 显示："准备验证：{prd_file_path}"
  - 显示："**正在进行验证...**"
  - 完整阅读并遵循：{validationWorkflow} (steps-v/step-v-01-discovery.md)
  - 注意：这将移交给验证工作流，该工作流将运行其完整的 13 步流程

- **如果 E (编辑更多):**
  - 显示："**额外编辑**"
  - 询问："你想进行什么额外编辑？"
  - 接受输入，然后显示："**返回编辑步骤...**"
  - 再次完整阅读并遵循：step-e-03-edit.md

- **如果 S (摘要):**
  - 显示详细摘要，包括：
    - 所做更改的完整列表
    - 前/后比较（关键改进）
    - 下一步建议
  - 显示："**编辑工作流完成**"
  - 退出

- **如果 X (退出):**
  - 显示摘要
  - 显示："**编辑工作流完成**"
  - 退出

- **如果 其他:** 帮助用户，然后重新显示菜单

---

## 🚨 系统成功/失败指标

### ✅ 成功：

- 准确编译完整的编辑摘要
- 所有更改都有清晰文档记录
- 展示带有明确预期的选项
- 验证选项与 steps-v 工作流无缝集成
- 用户可以验证、编辑更多或退出
- 清晰移交给验证工作流（如果选择）
- 编辑工作流正确完成

### ❌ 系统失败：

- 摘要中缺少更改
- 未提供验证选项
- 未正确记录完成情况
- 没有清晰移交给验证工作流

**主规则：** 编辑工作流与验证无缝集成。用户可以 编辑 → 验证 → 再次编辑 → 再次验证，处于迭代改进循环中。
