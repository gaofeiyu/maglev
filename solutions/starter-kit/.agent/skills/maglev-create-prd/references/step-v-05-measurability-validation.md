---
name: 'step-v-05-measurability-validation'
description: '可测量性验证 - 验证所有需求（FR 和 NFR）都是可测量和可测试的'

# File references (ONLY variables used in this step)
nextStepFile: './step-v-06-traceability-validation.md'
prdFile: '{prd_file_path}'
validationReportPath: '{validation_report_path}'
---

# 步骤 5: 可测量性验证

## 步骤目标：

验证所有功能需求（FR）和非功能需求（NFR）都是可测量的、可测试的，并且遵循正确的格式，没有实现细节。

## 强制执行规则 (请先阅读):

### 通用规则：

- 🛑 绝不 在没有用户输入的情况下生成内容
- 📖 关键：在采取任何行动之前，请阅读完整的步骤文件
- 🔄 关键：当使用 'C' 加载下一步时，确保已阅读整个文件
- 📋 你是一个协调员，而不是内容生成器
- ✅ 你必须始终使用配置的 `{communication_language}` 以你的 Agent 沟通风格输出语言

### 角色强化：

- ✅ 你是验证架构师和质量保证专家
- ✅ 如果你已经被赋予了沟通或人物模式，在扮演这个新角色时继续使用它们
- ✅ 我们参与系统验证，而不是协作对话
- ✅ 你带来分析严谨性和需求工程专业知识
- ✅ 此步骤自动运行 - 不需要用户输入

### 步骤特定规则：

- 🎯 仅关注 FR 和 NFR 可测量性
- 🚫 禁止 在此步骤中验证其他方面
- 💬 方法：逐个需求的系统分析
- 🚪 这是一个验证序列步骤 - 完成后自动继续

## 执行协议：

- 🎯 提取 PRD 中的所有 FR 和 NFR
- 💾 验证每一个的可测量性和格式
- 📖 将发现追加到验证报告
- 📖 显示 "正在进行下一步检查..." 并加载下一步
- 🚫 禁止 暂停或请求用户输入

## 上下文边界：

- 可用上下文：PRD 文件，验证报告
- 重点：仅 FR 和 NFR 可测量性
- 限制：不验证其他方面，不暂停等待用户输入
- 依赖项：步骤 2-4 已完成 - 初始验证检查已完成

## 强制序列

**关键：** 严格遵循此序列。除非用户明确要求更改，否则不要跳过、重新排序或即兴发挥。

### 1. 尝试子流程验证

**尝试使用 Task 工具生成子流程：**

"对此 PRD 执行可测量性验证：

**功能需求 (FR):**
1. 从功能需求部分提取所有 FR
2. 检查每个 FR 是否：
   - 符合 '[Actor] can [capability]' 格式
   - 无主观形容词（容易、快、简单、直观等）
   - 无模糊量词（多个、几个、一些、许多等）
   - 无实施泄漏（技术名称、库名称、数据结构，除非与能力相关）
3. 记录违规及行号

**非功能需求 (NFR):**
1. 从非功能需求部分提取所有 NFR
2. 检查每个 NFR 是否：
   - 具有测量方法的特定指标
   - 符合模板（标准、指标、测量方法、上下文）
   - 包含上下文（为什么这很重要，它影响谁）
3. 记录违规及行号

返回带有违规计数和示例的结构化发现。"

### 2. 优雅降级（如果 Task 工具不可用）

如果 Task 工具不可用，直接执行分析：

**功能需求分析：**

提取所有 FR 并检查每一个：

**格式合规性：**
- 是否遵循 "[Actor] can [capability]" 模式？
- Actor 是否明确定义？
- 能力是否可操作且可测试？

**无主观形容词：**
- 扫描：容易、快、简单、直观、用户友好、响应迅速、快速、高效（无指标）
- 注意行号

**无模糊量词：**
- 扫描：多个、几个、一些、许多、很少、各种、若干
- 注意行号

**无实施泄漏：**
- 扫描：React, Vue, Angular, PostgreSQL, MongoDB, AWS, Docker, Kubernetes, Redux 等
- 除非与能力相关（例如，"API 消费者可以访问..."）
- 注意行号

**非功能需求分析：**

提取所有 NFR 并检查每一个：

**特定指标：**
- 是否由可测量的标准？（例如，"响应时间 < 200ms"，而不是 "快速响应"）
- 这可以测量或测试吗？

**模板合规性：**
- 标准定义了吗？
- 指标指定了吗？
- 包含测量方法了吗？
- 提供上下文了吗？

### 3. 统计违规

**FR 违规：**
- 格式违规：计数
- 主观形容词：计数
- 模糊量词：计数
- 实施泄漏：计数
- FR 违规总数：总和

**NFR 违规：**
- 缺少指标：计数
- 模板不完整：计数
- 缺少上下文：计数
- NFR 违规总数：总和

**总违规：** FR 违规 + NFR 违规

### 4. 向验证报告报告可测量性发现

追加到验证报告：

```markdown
## 可测量性验证

### 功能需求

**已分析 FR 总数:** {count}

**格式违规:** {count}
[如果存在违规, 列出带有行号的示例]

**发现主观形容词:** {count}
[如果发现, 列出带有行号的示例]

**发现模糊量词:** {count}
[如果发现, 列出带有行号的示例]

**实施泄漏:** {count}
[如果发现, 列出带有行号的示例]

**FR 违规总计:** {total}

### 非功能需求

**已分析 NFR 总数:** {count}

**缺少指标:** {count}
[如果缺少, 列出带有行号的示例]

**模板不完整:** {count}
[如果不完整, 列出带有行号的示例]

**缺少上下文:** {count}
[如果缺少, 列出带有行号的示例]

**NFR 违规总计:** {total}

### 总体评估

**需求总数:** {FRs + NFRs}
**违规总数:** {FR violations + NFR violations}

**严重性:** [严重 如果 >10 违规, 警告 如果 5-10, 通过 如果 <5]

**推荐:**
[如果严重] "许多需求不可测量或不可测试。必须修订需求以供下游工作测试。"
[如果警告] "一些需求需要细化以提高可测量性。关注上面的违规需求。"
[如果通过] "需求表现出良好的可测量性，问题极少。"
```

### 5. 显示进度并自动继续

显示："**可测量性验证完成**

总违规：{count} ({severity})

**正在进行下一步验证检查...**"

毫不延迟，完整阅读并遵循：{nextStepFile} (step-v-06-traceability-validation.md)

---

## 🚨 系统成功/失败指标

### ✅ 成功：

- 提取并分析所有 FR 的可测量性
- 提取并分析所有 NFR 的可测量性
- 带有行号记录违规
- 正确评估严重性
- 将发现报告给验证报告
- 自动继续进行下一个验证步骤
- 尝试子流程架构并进行优雅降级

### ❌ 系统失败：

- 未分析所有 FR 和 NFR
- 违规缺少行号
- 未将发现报告给验证报告
- 未评估严重性
- 未自动继续

**主规则：** 需求必须可测试才有用。验证每个需求的可测量性，记录违规，自动继续。
